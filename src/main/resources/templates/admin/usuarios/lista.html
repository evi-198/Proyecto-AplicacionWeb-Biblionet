<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<body>

<div class="p-6">

    <!-- Título + botones -->
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold text-purple-700">Gestión de Usuarios</h1>

        <div class="flex gap-3">

            <!-- Nuevo usuario -->
            <a href="/admin/usuarios/nuevo"
               class="px-4 py-2 border border-purple-500 text-purple-400 rounded-lg 
                      hover:bg-purple-500 hover:text-white transition">
                + Nuevo Usuario
            </a>

        </div>
    </div>

    <!-- Mensajes -->
    <div th:if="${param.success}" class="mb-4 p-3 bg-green-700 text-green-100 rounded">
        Usuario registrado exitosamente.
    </div>

    <div th:if="${param.updated}" class="mb-4 p-3 bg-blue-700 text-blue-100 rounded">
        Usuario actualizado.
    </div>

    <div th:if="${param.deleted}" class="mb-4 p-3 bg-red-700 text-red-100 rounded">
        Usuario eliminado.
    </div>

    <div th:if="${param.error}" class="mb-4 p-3 bg-red-800 text-red-200 rounded">
        Ocurrió un error procesando la acción.
    </div>

    <!-- CONTENEDOR neutro claro -->
    
    <div class="overflow-x-auto border border-gray-700 rounded-lg bg-[#e7ebf3] text-gray-900 shadow-lg max-w-5xl mx-auto">

        <table class="min-w-full">
            <thead class="bg-[#d5d9e2] text-gray-800">
            <tr>
                <th class="px-4 py-3 text-left">ID</th>
                <th class="px-4 py-3 text-left">Nombre</th>
                <th class="px-4 py-3 text-left">DNI</th>
                <th class="px-4 py-3 text-left">Rol</th>
                <th class="px-4 py-3 text-left">Estado</th>
                <th class="px-4 py-3 text-center">Acciones</th>
            </tr>
            </thead>

            <tbody class="text-gray-900">
            <tr th:each="u : ${usuarios}"
                class="border-b border-gray-300 hover:bg-[#f3f5f9] transition">
                <td class="px-4 py-3" th:text="${u.id}"></td>
                <td class="px-4 py-3" th:text="${u.nombre + ' ' + u.apellido}"></td>
                <td class="px-4 py-3" th:text="${u.dni}"></td>
                <td class="px-4 py-3" th:text="${u.rol.nombre}"></td>

                <td class="px-4 py-3">
                    <span th:switch="${u.estado.name()}">
                        <span th:case="'activo'"
                              class="px-2 py-1 bg-green-200 text-green-900 rounded text-sm">Activo</span>
                        <span th:case="'inactivo'"
                              class="px-2 py-1 bg-red-200 text-red-900 rounded text-sm">Inactivo</span>
                    </span>
                </td>

                <td class="px-4 py-3 text-center flex gap-2 justify-center">

                    <!-- Ver -->
                    <a th:href="@{'/admin/usuarios/detalle/' + ${u.id}}"
                       class="px-3 py-1 border border-purple-500 text-purple-500 rounded 
                              hover:bg-purple-500 hover:text-white transition text-sm">
                        Ver
                    </a>

                    <!-- Editar -->
                    <a th:href="@{'/admin/usuarios/editar/' + ${u.id}}"
                       class="px-3 py-1 border border-purple-500 text-purple-500 rounded 
                              hover:bg-purple-500 hover:text-white transition text-sm">
                        Editar
                    </a>

                    <!-- Eliminar - Cambia el formulario existente -->
                    <form th:action="@{'/admin/usuarios/eliminar/' + ${u.id}}"
                          method="post"
                          onsubmit="return confirm('¿ELIMINACIÓN DEFINITIVA?\\n\\n⚠️ ADVERTENCIA: Esta acción eliminará permanentemente al usuario de la base de datos.\\n\\n¿Está seguro que desea continuar?');">
                        <button type="submit"
                                class="px-3 py-1 border border-red-500 text-red-500 rounded 
                                       hover:bg-red-500 hover:text-white transition text-sm">
                            Eliminar
                        </button>
                    </form>

                </td>
            </tr>

            <tr th:if="${usuarios.size() == 0}">
                <td colspan="6" class="text-center py-4 text-gray-700">
                    No hay usuarios registrados.
                </td>
            </tr>

            </tbody>
        </table>

    </div>

</div>

</body>
</html>