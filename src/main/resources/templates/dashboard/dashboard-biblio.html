<div th:fragment="dashboard-biblio">

    <h2 class="text-2xl font-bold text-blue-600 mb-6">Dashboard Bibliotecario</h2>

    <!-- TARJETAS KPI -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">

        <div class="bg-gray-800 p-4 rounded-xl shadow text-center flex flex-col items-center">
            <div class="text-blue-400 mb-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 20l9-5-9-5-9 5 9 5z" />
                </svg>
            </div>
            <p class="text-gray-400 text-sm">Libros Registrados</p>
            <h3 class="text-3xl font-bold text-blue-400" th:text="${libros}">0</h3>
        </div>

		<!-- Categorías -->
		       <div class="bg-gray-800 p-4 rounded-xl shadow text-center flex flex-col items-center">
		           <div class="text-blue-400 mb-2">
		               <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
		                   <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
		                         d="M4 6h16M4 12h16M4 18h16" />
		               </svg>
		           </div>
		           <p class="text-gray-400 text-sm">Categorías</p>
		           <h3 class="text-3xl font-bold text-blue-400"
		               th:text="${categorias}">0</h3>
		       </div>

			   <!-- Préstamos Pendientes -->
			           <div class="bg-gray-800 p-4 rounded-xl shadow text-center flex flex-col items-center">
			               <div class="text-blue-400 mb-2">
			                   <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none"
			                        viewBox="0 0 24 24" stroke="currentColor">
			                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
			                             d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
			                   </svg>
			               </div>
			               <p class="text-gray-400 text-sm">Devoluciones Pendientes</p>
			               <h3 class="text-3xl font-bold text-blue-400"
			                   th:text="${totalHistorialPrestamos}">0</h3>
			          </div>

    </div>

    <!-- GRAFICOS -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

        <div class="bg-gray-800 p-4 rounded-xl shadow">
            <h3 class="text-lg text-blue-300 mb-3">Préstamos por Día</h3>
            <canvas id="chartDia"></canvas>
        </div>

        <div class="bg-gray-800 p-4 rounded-xl shadow">
            <h3 class="text-lg text-blue-300 mb-3">Ejemplares por Estado</h3>
            <canvas id="chartEstado"></canvas>
        </div>

    </div>

	<script th:inline="javascript">
	    document.addEventListener("DOMContentLoaded", function() {
	        // 1. Datos de Thymeleaf
	        const labelsDia = /*[[${labelsDia}]]*/ [];
	        const dataDia = /*[[${dataDia}]]*/ [];
	        const labelsEstado = /*[[${labelsEstado}]]*/ [];
	        const dataEstado = /*[[${dataEstado}]]*/ [];

	        // 2. Gráfico de Préstamos por Día
	        if (document.getElementById('chartDia')) {
	            new Chart(document.getElementById('chartDia'), {
	                type: 'line',
	                data: {
	                    labels: labelsDia,
	                    datasets: [{
	                        label: 'Cantidad de Préstamos',
	                        data: dataDia,
	                        borderColor: '#60a5fa',
	                        backgroundColor: 'rgba(96, 165, 250, 0.2)',
	                        fill: true,
	                        tension: 0.3
	                    }]
	                },
	                options: {
	                    responsive: true,
	                    scales: {
	                        y: { beginAtZero: true, ticks: { stepSize: 1 } }
	                    }
	                }
	            });
	        }

	        // 3. Gráfico de Ejemplares por Estado
	        if (document.getElementById('chartEstado')) {
	            new Chart(document.getElementById('chartEstado'), {
	                type: 'bar',
	                data: {
	                    labels: labelsEstado,
	                    datasets: [{
	                        label: 'Ejemplares',
	                        data: dataEstado,
	                        backgroundColor: ['#34d399', '#fbbf24', '#f87171']
	                    }]
	                },
	                options: {
	                    responsive: true,
	                    scales: {
	                        y: { beginAtZero: true, ticks: { stepSize: 1 } }
	                    }
	                }
	            });
	        }
	    });
	</script>

</div>